# 浏览器工具集

- 作者：codehackfox@gmail.com
- 时间：2019-07-12 10:13:23

[TOC]
总体概览
设计模式
存储结构
读写流程
impala结合
限制条件
文档资源


> ## 0x00、总体概览

### 1.产生缘由
    2012年10月由Cloudera公司发起创建,2015年10月对外公布，2015年12月进入apache基金会进行孵化，后续进入快速发展轨道。产品定位： Fast Analytics on Fast Data。


> ## 0x01、设计模式


> ## 0x02、存储结构


> ## 0x03、读写流程


> ## 0x04、impala结合


> ## 0x05、限制条件

### 1.表限制
* 表的备份数必须为奇数，最⼤大为7
* 备份数在设置后不不可修改
* 删除表后空间会⽴立⻢马释放
* 建表时partition总数限制为60个，后续可以添加

### 2.列限制
* 部分数据类型不支持，如CHAR, VARCHAR, DATE, ARRAY等
* 数据类型以及是否可为空等列列属性不支持修改
* 一张表最多有300列列
* 删除列列的时候不会立马清除空间，需要执⾏Compaction操作，但是 Compaction操作不⽀持手动执行

### 3.主键限制
* 表创建后主键不不可更更改
* 主键字段必须在其他字段之前定义
* ⼀行对应的主键内容不可以被Update操作修改。要修改⼀行的主键值，需 要删除并新增⼀行新数据，并且该操作无法保持原子性
* 主键的类型不支持DOUBLE、FLOAT、BOOL，且必须是非空的(NOT NULL)
* 不支持⾃自动⽣生成主键
* 每行对应的主键存储单元(CELL)最⼤为16KB

### 4.单元限制
* 单元对应的数据最⼤大为64KB，并且是在压缩前

### 5.分片限制
* 分⽚只支持手动指定，⾃自动分⽚不支持
* 分片设定不不⽀支持修改，修改分⽚设定需要”建新表-导数据-删老表”操作;
* 丢掉多数备份的Tablets需要⼿手动修复。
* Range⽀持删除或新增

### 6.容量建议
* 建议tablet servers的最⼤大数量量为100;
* 建议masters的最⼤大数量量为3;
* 建议每个tablet server存储的数据最大为8T
* 每个tablet server存储的tablets数量建议在1000以内;
* 每个表分片后的tablets存储在单个tablet server的最⼤大数量为60。

### 7.Impala集成限制
* 不支持varchar、array、map、struct等类型
* Impala⼤小写不不敏敏感，kudu是⼤小写敏敏感，所以表名及字段最好都是小写
* !=和like查询是kudu把数据全部给impala，然后在过滤的，相⽐其他操作效率要低
* Updates、inserts、deletes都是⾮非事务的
* 一条sql的并发执⾏行行数在于tablets的个数，所以推荐⾄至少有10个tablets

### 8.其他限制
* 主键有索引，不支持⼆级索引(Secondary indexes)
* 不支持多⾏行行的事务操作
* 关系型数据的一些功能，如外键，不支持;
* 列和表的名字强制为UTF-8编码，并且最大256字节

> ## 0x06、文档资源

* https://kudu.apache.org/kudu.pdf
* https://www.cloudera.com/documentation/enterprise/latest/PDF/cloudera-kudu.pdf
* https://kudu.apache.org/docs/
* https://github.com/apache/kudu/blob/master/docs/design-docs/tablet.md
* https://github.com/apache/kudu/blob/master/docs/design-docs/cfile.md
* https://raft.github.io/raft.pdf
* https://impala.apache.org/docs/build/impala-2.8.pdf
* https://www.cloudera.com/documentation/enterprise/5-10-x/topics/ impala_tutorial.html