---
layout: post
title:  "kudu文档"
date:   2019-04-15 14:53:45 +0800
categories: 大数据
---

- 作者：codehackfox@gmail.com
- 时间：2019-04-15 11:11:30

> ### 0x00、总体设计

- 模式设计对于实现 Kudu 的最佳性能和运行稳定性至关重要。每个工作负载都是独一无二的，没有一个最合适每个表的单一模式设计。
- 列设计，主键设计和分区设计。

- 完美的模式将完成以下工作：
    * 数据将以这样的方式进行分发，即读取和写入在 tablet servers 上均匀分布。这受到分区的影响。
    * Tablets 将以均匀，可预测的速度增长， tablets 的负载将随着时间的推移而保持稳定。这最受影响分区。
    * 扫描将读取完成查询所需的最少数据量。这主要受到主键设计的影响，但分区也通过分区修剪来起作用。
- Kudu 表由一个列或多个列组成，每个列都有一个定义的类型。不属于主键的列可能为空。支持的列类型包括：
boolean
8-bit signed integer
16-bit signed integer
32-bit signed integer
64-bit signed integer
unixtime_micros (从 UNIX 时代起，64 位微秒)
single-precision (32-bit) IEEE-754 floating-point number ( 单精度，32位，IEEE-754 浮点数 )
double-precision (64-bit) IEEE-754 floating-point number ( 双精度，64位，IEEE-754 浮点数 )
UTF-8 encoded string (up to 64KB uncompressed) ( UTF-8 编码字符串（高达 64KB 未压缩） )
binary (up to 64KB uncompressed) ( 二进制（高达 64KB 未压缩） )

Kudu 利用强类型的列和柱状磁盘存储格式来提供高效的编码和序列化。为了充分利用这些功能，列应该被指定为适当的类型，而不是使用字符串或二进制列来模拟 'schemaless' 表，否则可能会进行结构化。除了编码之外，Kudu 允许按照每列进行压缩。


> ### Known Limitations ( 已知限制 )

- Kudu 目前有一些已知的限制，可能会影响模式设计。

- `Number of Columns ( 列数 )`
    * 默认情况下，Kudu 不允许创建 300 列以上的表。我们建议使用较少列的模式设计来获得最佳性能。
- `Size of Cells ( 单元格大小 )`
    * 在编码或压缩之前，没有单个单元格可能大于 64KB 。组合密钥的单元在 Kudu 完成的内部复合密钥编码之后，总共限制在 16KB 。插入不符合这些限制的行将导致错误返回给客户端。
- `Size of Rows ( 行大小 )`
    * 尽管单个单元格可能高达 64KB ，而 Kudu 最多支持 300 列，但建议不要单行大于几百 KB 。
- `Valid Identifiers ( 有效标识符 )`
    * 诸如表和列名称的标识符必须是有效的 UTF-8 序列，不超过 256 个字节。
- `Immutable Primary Keys ( 不可变的主键 )`
    * Kudu 不允许您更新一行的主键列。
- `Non-alterable Primary Key ( 不可更改的主键 )`
    * 表创建后，Kudu 不允许您更改主键列。
- `Non-alterable Partitioning ( 不可更改的分区 )`
    * Kudu 不允许您更改创建后如何分区表，但添加或删除范围分区除外。
- `Non-alterable Column Types ( 不可更改的列类型 )`
    * Kudu 不允许更改列的类型。
- `Partition Splitting ( 分区切分 )`
    * 表创建后，分区不能拆分或合并。